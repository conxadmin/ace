FROM jeanblanchard/busybox-java:8

MAINTAINER jeanblanchard

# Set env
ENV HTTP_PORT 9000
ENV ACE_SERVER localhost:9000
ENV ACE_OBR    localhost:9000
ENV OSGI_SHELL_TELNET_IP 127.0.0.1
ENV OSGI_SHELL_TELNET_PORT 6666
ENV OSGI_SHELL_TELNET_MAXCONN 2
ENV OSGI_SHELL_TELNET_SOCKETTIMEOUT 0

# install ace (for target only)
COPY apache-ace-2.1.0 /root/apache-ace-2.1.0/
#ADD backups/store2Jun2016.tar.gz /root/apache-ace-2.1.0/obr/


##################################################################################################
## START CUSTOMIZATION

# Create a mount point
# VOLUME ["/data/apache-ace-server"]

# Expose ports
EXPOSE 6666 8080 9000

# Add the Apache Ace start script (executed on a `docker run`).
ADD init-container-script.sh /root/apache-ace-2.1.0/obr/init_apache_ace_server.sh
RUN chmod +x /root/apache-ace-2.1.0/obr/init_apache_ace_server.sh

# Add the Apache Ace start script (executed on a `docker run`).
ADD start-container-script.sh /root/apache-ace-2.1.0/obr/start_apache_ace_server.sh
RUN chmod +x /root/apache-ace-2.1.0/obr/start_apache_ace_server.sh

WORKDIR /root/apache-ace-2.1.0/obr

# Use baseimage-docker's init system.
CMD ["sh","init_apache_ace_server.sh"]

